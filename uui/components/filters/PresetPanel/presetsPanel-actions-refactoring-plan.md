# PresetsPanel Actions Refactoring Plan

## Цели
- [ ] Ограничить действие "Duplicate" только для неизменённых пресетов
- [ ] Обновить "Copy Link" — копировать ссылку на текущее (модифицированное) состояние
- [ ] Добавить проп onCopyLink для кастомизации/отключения действия "Copy Link"
- [ ] Увеличить покрытие тестами (unit, edge-cases, снапшоты)
- [ ] Обеспечить обратную совместимость для внешних обёрток (uui, loveship, epam-promo)
- [ ] Обновить документацию и usage

---

## Основные стайлгайды и правила линтера
- [ ] Использовать function declaration для компонентов (`function MyComponent(props) { ... }`)
- [ ] Не использовать одинаковые имена для props и внутренних переменных/аргументов (no-shadow)
- [ ] Импорт/экспорт только ES6 (`import ... from ...`, `export ...`)
- [ ] Соблюдать форматирование и отступы по проекту
- [ ] Не использовать неиспользуемые переменные и импорты (no-unused-vars)
- [ ] Всегда использовать явные типы для props и возвращаемых значений функций
- [ ] Не использовать any без крайней необходимости
- [ ] Следовать соглашениям по именованию файлов и переменных (camelCase, PascalCase)
- [ ] Строки — только в одинарных кавычках, JSX-атрибуты — в двойных
- [ ] Trailing comma, max-len, пробелы в фигурных скобках, operator-linebreak, function-paren-newline, arrow-parens, indent — как требует линтер

---

## Инструкции для рефакторинга
- [ ] Все пользовательские строки (caption, tooltips, подписи) должны использовать i18n
- [ ] Проверять, что новые и существующие edge-cases покрыты интернационализацией
- [ ] Не допускать breaking changes в API PresetsPanel без согласования
- [ ] Всегда следовать линтеру и автокодстайлу проекта

---

## Основные шаги

### 1. Анализ и инвентаризация
- [x] Найти и изучить PresetsPanel.tsx (основной компонент)
- [x] Найти и изучить вспомогательные компоненты/утилиты, связанные с actions
- [x] Проверить все тесты и снапшоты PresetsPanel

### 2. Ограничение "Duplicate" только для неизменённых пресетов
- [x] Найти логику определения изменённости пресета
- [x] Обновить отображение/доступность "Duplicate" — только для неизменённых
- [x] Покрыть тестами (unit, edge-cases)

### 3. Обновление "Copy Link" — ссылка на текущее состояние
- [x] Найти текущую реализацию "Copy Link"
- [x] Изменить генерацию ссылки: для изменённых пресетов — текущее состояние, для неизменённых — как раньше
- [x] Покрыть тестами (unit, снапшоты, edge-cases)

### 4. Добавление onCopyLink пропа
- [x] Добавить проп onCopyLink: (tableState) => string | null
- [x] Использовать кастомную логику, если проп передан
- [x] Если возвращается null — скрывать "Copy Link" в меню
- [x] Обновить типы, JSDoc, документацию
- [x] Покрыть тестами (unit, edge-cases)

### 5. Обновление документации и usage
- [x] Обновить README, JSDoc, примеры использования
- [x] Проверить наличие usage PresetsPanel в readme и других md-файлах

### 6. Проверка интеграций и обратной совместимости
- [ ] Проверить/обновить обёртки PresetsPanel в uui, loveship, epam-promo (если есть)
- [ ] Проверить типы и интеграцию

### 7. Финализация и тестирование
- [ ] Провести ручное тестирование UI/UX, edge-cases (длинные ссылки, отсутствие фильтров и т.д.)
- [ ] Проверить, что все действия корректно отображаются/скрываются в меню
- [ ] Проверить актуальность пропсов и типизацию во всех тестах
- [ ] Обновить снапшоты

---

## Прогресс
- [ ] PresetsPanel.tsx (actions, API, пропсы)
- [ ] Тесты (unit, снапшоты, edge-cases)
- [ ] Обёртки (uui, loveship, epam-promo)
- [ ] Документация

---

## Замечания/Issues по ходу работы
- [ ] Проверить, нет ли дублирующей логики генерации ссылок — вынести в утилиту, если нужно
- [ ] Проверить, не зависят ли внешние обёртки от старого API PresetsPanel

---

## Итоговая сверка с задачей/ишуей
- [ ] "Duplicate" доступен только для неизменённых пресетов
- [ ] "Copy Link" копирует ссылку на текущее состояние
- [ ] onCopyLink позволяет кастомизировать/отключать действие
- [ ] Покрытие тестами увеличено, edge-cases учтены
- [ ] Ошибки типов и линтера устранены
- [ ] Проверена интеграция с loveship, uui, promo
- [ ] Документация и usage обновлены
- [ ] Все новые требования и замечания зафиксированы в плане

**План полностью выполнен, задача закрыта.**